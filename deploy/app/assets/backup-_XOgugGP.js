const __vite__fileDeps=["assets/index-DCzl8a2M.js","assets/index-BDXx1mQP.css"],__vite__mapDeps=i=>i.map(i=>__vite__fileDeps[i]);
import{f as N,r as i,u as O,j as e,C as y,B as r,d as p,L as J,I as k,ae as w,_ as D,b as A,a7 as C}from"./index-DCzl8a2M.js";import{A as E,a as F,b as L,c as U,d as B,e as R,f as T,g as P}from"./alert-dialog-mt10r_ul.js";import{S as H}from"./save-CuLUMJM-.js";/**
 * @license lucide-react v0.394.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $=N("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.394.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const z=N("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);function M(){const[l,g]=i.useState(!1),[n,S]=i.useState(!1),[h,b]=i.useState(!1),[d,u]=i.useState(null),{toast:s}=O(),x=()=>{var a;g(!0);try{const t={employees:JSON.parse(localStorage.getItem("employees")||"[]"),advances:JSON.parse(localStorage.getItem("advances")||"[]"),absences:JSON.parse(localStorage.getItem("absences")||"[]"),salaries:JSON.parse(localStorage.getItem("salaries")||"[]"),users:JSON.parse(localStorage.getItem("users")||"[]"),mock_auth_users:JSON.parse(localStorage.getItem("mock_auth_users")||"[]"),activity_logs:JSON.parse(localStorage.getItem("activity_logs")||"[]"),system_settings:JSON.parse(localStorage.getItem("system_settings")||"{}"),metadata:{version:"1.0",timestamp:new Date().toISOString(),device:navigator.userAgent,exportedBy:((a=JSON.parse(localStorage.getItem("auth_user")||"{}"))==null?void 0:a.name)||"Unknown"}},f=JSON.stringify(t,null,2),m=new Blob([f],{type:"application/json"}),o=URL.createObjectURL(m),c=document.createElement("a");c.href=o,c.download=`salary-system-backup-${new Date().toISOString().split("T")[0]}.json`,document.body.appendChild(c),c.click(),URL.revokeObjectURL(o),document.body.removeChild(c),s({title:"تم التصدير بنجاح",description:"تم تصدير بيانات النظام بنجاح"})}catch(t){console.error("Error exporting data:",t),s({title:"خطأ",description:`حدث خطأ أثناء تصدير البيانات: ${t instanceof Error?t.message:"خطأ غير معروف"}`,variant:"destructive"})}finally{g(!1)}},j=()=>{d?b(!0):s({title:"خطأ",description:"الرجاء اختيار ملف للاستيراد",variant:"destructive"})},v=async()=>{if(d){S(!0);try{const a=await d.text(),t=JSON.parse(a);if(!t.employees||!t.advances||!t.users)throw new Error("الملف غير صالح أو لا يحتوي على البيانات المطلوبة");const f={employees:JSON.parse(localStorage.getItem("employees")||"[]"),advances:JSON.parse(localStorage.getItem("advances")||"[]"),absences:JSON.parse(localStorage.getItem("absences")||"[]"),salaries:JSON.parse(localStorage.getItem("salaries")||"[]"),users:JSON.parse(localStorage.getItem("users")||"[]"),activity_logs:JSON.parse(localStorage.getItem("activity_logs")||"[]"),system_settings:JSON.parse(localStorage.getItem("system_settings")||"{}")};localStorage.setItem("_backup_before_import",JSON.stringify(f)),localStorage.setItem("employees",JSON.stringify(t.employees)),localStorage.setItem("advances",JSON.stringify(t.advances)),localStorage.setItem("absences",JSON.stringify(t.absences||[])),localStorage.setItem("salaries",JSON.stringify(t.salaries||[])),localStorage.setItem("users",JSON.stringify(t.users)),t.mock_auth_users&&localStorage.setItem("mock_auth_users",JSON.stringify(t.mock_auth_users)),localStorage.setItem("activity_logs",JSON.stringify(t.activity_logs||[])),t.system_settings&&localStorage.setItem("system_settings",JSON.stringify(t.system_settings));const m=JSON.parse(localStorage.getItem("auth_user")||"null");if(m)try{const{logActivity:o}=await D(async()=>{const{logActivity:c}=await import("./index-DCzl8a2M.js").then(_=>_.at);return{logActivity:c}},__vite__mapDeps([0,1]));o("setting","import","تم استيراد بيانات النظام من نسخة احتياطية",m.id,{timestamp:new Date().toISOString()})}catch(o){console.error("Failed to log import activity",o)}s({title:"تم الاستيراد بنجاح",description:"تم استيراد بيانات النظام بنجاح. قم بتحديث الصفحة لرؤية التغييرات."}),b(!1),u(null),setTimeout(()=>{window.location.reload()},2e3)}catch(a){console.error("Error importing data:",a),s({title:"خطأ",description:`حدث خطأ أثناء استيراد البيانات: ${a instanceof Error?a.message:"خطأ غير معروف"}`,variant:"destructive"})}finally{S(!1)}}},I=()=>{try{const a=localStorage.getItem("_backup_before_import");if(!a){s({title:"خطأ",description:"لا توجد نسخة احتياطية للاستعادة",variant:"destructive"});return}const t=JSON.parse(a);localStorage.setItem("employees",JSON.stringify(t.employees)),localStorage.setItem("advances",JSON.stringify(t.advances)),localStorage.setItem("absences",JSON.stringify(t.absences||[])),localStorage.setItem("salaries",JSON.stringify(t.salaries||[])),localStorage.setItem("users",JSON.stringify(t.users)),localStorage.setItem("activity_logs",JSON.stringify(t.activity_logs||[])),t.system_settings&&localStorage.setItem("system_settings",JSON.stringify(t.system_settings)),s({title:"تم الاستعادة بنجاح",description:"تم استعادة بيانات النظام من النسخة الاحتياطية بنجاح. قم بتحديث الصفحة لرؤية التغييرات."}),setTimeout(()=>{window.location.reload()},2e3)}catch(a){console.error("Error restoring backup:",a),s({title:"خطأ",description:`حدث خطأ أثناء استعادة النسخة الاحتياطية: ${a instanceof Error?a.message:"خطأ غير معروف"}`,variant:"destructive"})}};return e.jsxs("div",{className:"space-y-6 tempo-efb3d3e5-ad70-5767-a560-645bddf74129",tempoelementid:"tempo-efb3d3e5-ad70-5767-a560-645bddf74129",children:[e.jsxs(y,{className:"p-6 tempo-a6c5c5d6-2302-504b-be77-8efeb7dfbb75",tempoelementid:"tempo-a6c5c5d6-2302-504b-be77-8efeb7dfbb75",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4 tempo-4dc4496d-f05b-5471-b775-d7cd17f08cbd",tempoelementid:"tempo-4dc4496d-f05b-5471-b775-d7cd17f08cbd",children:"تصدير البيانات"},"181172076415808087502918479870651084243-3"),e.jsx("p",{className:"text-muted-foreground mb-4 tempo-c7c9318d-e728-5654-a061-b2fababc6163",tempoelementid:"tempo-c7c9318d-e728-5654-a061-b2fababc6163",children:"قم بتصدير جميع بيانات النظام إلى ملف JSON. يمكنك استخدام هذا الملف لاستعادة البيانات لاحقاً."},"181172076415808087502918479870651084243-4"),e.jsx(r,{onClick:x,disabled:l,className:"tempo-397814d4-04e2-5127-91af-89c504befa93 ",tempoelementid:"tempo-397814d4-04e2-5127-91af-89c504befa93",children:l?e.jsxs(e.Fragment,{children:[e.jsx(p,{size:"sm",className:"ml-2 tempo-495b110d-a6e3-5fe5-b726-1a39afa6cb3a",tempoelementid:"tempo-495b110d-a6e3-5fe5-b726-1a39afa6cb3a"}),"جاري التصدير..."]}):e.jsxs(e.Fragment,{children:[e.jsx($,{className:"ml-2 h-4 w-4 tempo-fa548288-c818-566e-9629-f1f459df17a3",tempoelementid:"tempo-fa548288-c818-566e-9629-f1f459df17a3"}),"تصدير البيانات"]})})]}),e.jsxs(y,{className:"p-6 tempo-db423b5c-1d74-5c49-a8b2-8d3eeafbafbd",tempoelementid:"tempo-db423b5c-1d74-5c49-a8b2-8d3eeafbafbd",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4 tempo-1d265f76-8dae-5358-872a-1ec5ec30ad55",tempoelementid:"tempo-1d265f76-8dae-5358-872a-1ec5ec30ad55",children:"استيراد البيانات"},"181172076415808087502918479870651084243-9"),e.jsx("p",{className:"text-muted-foreground mb-4 tempo-211d3d0b-7180-5bab-a8f3-fa8d2fffcc95",tempoelementid:"tempo-211d3d0b-7180-5bab-a8f3-fa8d2fffcc95",children:"قم باستيراد بيانات النظام من ملف JSON تم تصديره مسبقاً. سيتم استبدال جميع البيانات الحالية بالبيانات المستوردة."},"181172076415808087502918479870651084243-10"),e.jsxs("div",{className:"space-y-4 tempo-66a4ce81-0960-5fed-9c4f-eb2d035e8cc5",tempoelementid:"tempo-66a4ce81-0960-5fed-9c4f-eb2d035e8cc5",children:[e.jsxs("div",{className:"space-y-2 tempo-db543790-797e-5984-984b-9bab9e0a0c8b",tempoelementid:"tempo-db543790-797e-5984-984b-9bab9e0a0c8b",children:[e.jsx(J,{className:"tempo-1c4c5c8b-c99d-5b84-b730-878fa117f8c4 ",tempoelementid:"tempo-1c4c5c8b-c99d-5b84-b730-878fa117f8c4",children:"اختر ملف الاستيراد"}),e.jsx(k,{type:"file",accept:".json",onChange:a=>{var t;return u(((t=a.target.files)==null?void 0:t[0])||null)},className:"text-right tempo-fc9a94af-d41f-5e74-8670-eda6edea548f",tempoelementid:"tempo-fc9a94af-d41f-5e74-8670-eda6edea548f"})]},"181172076415808087502918479870651084243-12"),e.jsxs("div",{className:"flex gap-4 tempo-1b531ee5-964f-55e6-a19c-1cde2f8513cc",tempoelementid:"tempo-1b531ee5-964f-55e6-a19c-1cde2f8513cc",children:[e.jsx(r,{onClick:j,disabled:n||!d,className:"tempo-7a57e6de-55b4-5bfb-a3e0-5ca56e0c0529 ",tempoelementid:"tempo-7a57e6de-55b4-5bfb-a3e0-5ca56e0c0529",children:n?e.jsxs(e.Fragment,{children:[e.jsx(p,{size:"sm",className:"ml-2 tempo-88717471-7560-52aa-8b41-f8b6603874c5",tempoelementid:"tempo-88717471-7560-52aa-8b41-f8b6603874c5"}),"جاري الاستيراد..."]}):e.jsxs(e.Fragment,{children:[e.jsx(z,{className:"ml-2 h-4 w-4 tempo-674a15f5-13f5-573e-8208-2feb66f289d2",tempoelementid:"tempo-674a15f5-13f5-573e-8208-2feb66f289d2"}),"استيراد البيانات"]})}),e.jsxs(r,{variant:"outline",onClick:I,disabled:!localStorage.getItem("_backup_before_import"),className:"tempo-591b911b-26fb-5476-bbd9-ff94abcd1adb ",tempoelementid:"tempo-591b911b-26fb-5476-bbd9-ff94abcd1adb",children:[e.jsx(H,{className:"ml-2 h-4 w-4 tempo-7cc957f2-63d8-590b-a30b-b9e8f416a282",tempoelementid:"tempo-7cc957f2-63d8-590b-a30b-b9e8f416a282"}),"استعادة النسخة الاحتياطية السابقة"]})]},"181172076415808087502918479870651084243-15")]},"181172076415808087502918479870651084243-11")]}),e.jsx(E,{open:h,onOpenChange:b,className:"tempo-1ffac181-577d-599c-838c-87367333d749 ",tempoelementid:"tempo-1ffac181-577d-599c-838c-87367333d749",children:e.jsxs(F,{dir:"rtl",className:"tempo-73999fb4-dda5-5cd6-850c-2ab8baeff1df ",tempoelementid:"tempo-73999fb4-dda5-5cd6-850c-2ab8baeff1df",children:[e.jsxs(L,{className:"tempo-93339b6f-b079-5776-967d-0e7f17c66dc8 ",tempoelementid:"tempo-93339b6f-b079-5776-967d-0e7f17c66dc8",children:[e.jsx(U,{className:"tempo-57bd4af9-6994-5be5-b699-859e6c7fc7e8 ",tempoelementid:"tempo-57bd4af9-6994-5be5-b699-859e6c7fc7e8",children:"تأكيد استيراد البيانات"}),e.jsxs(B,{className:"tempo-c519485e-b82a-5505-a440-3d298a1466c3 ",tempoelementid:"tempo-c519485e-b82a-5505-a440-3d298a1466c3",children:[e.jsxs("div",{className:"flex items-start gap-2 mb-2 tempo-1b75ab00-a640-5cc6-b957-8221bc9d770d",tempoelementid:"tempo-1b75ab00-a640-5cc6-b957-8221bc9d770d",children:[e.jsx(w,{className:"h-5 w-5 text-amber-500 flex-shrink-0 mt-0.5 tempo-e77815f1-45d1-5fc9-83fc-f169a7509109",tempoelementid:"tempo-e77815f1-45d1-5fc9-83fc-f169a7509109"}),e.jsx("span",{className:"tempo-515badd3-ed65-5e21-b243-4ef7537822ce ",tempoelementid:"tempo-515badd3-ed65-5e21-b243-4ef7537822ce",children:"سيتم استبدال جميع البيانات الحالية بالبيانات المستوردة. هذا الإجراء لا يمكن التراجع عنه."},"181172076415808087502918479870651084243-28")]},"181172076415808087502918479870651084243-26"),e.jsx("p",{className:"tempo-f43be741-9a95-59c4-987f-9fc2b050a4b4 ",tempoelementid:"tempo-f43be741-9a95-59c4-987f-9fc2b050a4b4",children:"سيتم إنشاء نسخة احتياطية من البيانات الحالية قبل الاستيراد يمكنك استعادتها في حالة حدوث أي مشكلة."},"181172076415808087502918479870651084243-29")]})]}),e.jsxs(R,{className:"flex-row-reverse justify-start gap-2 tempo-e001d336-407e-5670-9c7f-6e1b3d44bbf4",tempoelementid:"tempo-e001d336-407e-5670-9c7f-6e1b3d44bbf4",children:[e.jsx(T,{className:"tempo-73d7ad1e-a643-5ccd-a4c4-66cf5a347313 ",tempoelementid:"tempo-73d7ad1e-a643-5ccd-a4c4-66cf5a347313",children:"إلغاء"}),e.jsx(P,{onClick:v,className:"bg-destructive hover:bg-destructive/90 tempo-dbd84ad5-4082-5fa0-88a7-609e44368ec7",tempoelementid:"tempo-dbd84ad5-4082-5fa0-88a7-609e44368ec7",children:n?e.jsxs(e.Fragment,{children:[e.jsx(p,{size:"sm",className:"ml-2 tempo-03b4aca1-ef7d-5e55-944d-0c1d547e8b8a",tempoelementid:"tempo-03b4aca1-ef7d-5e55-944d-0c1d547e8b8a"}),"جاري الاستيراد..."]}):"تأكيد الاستيراد"})]})]})})]},"181172076415808087502918479870651084243-1")}function K(){const{hasPermission:l}=A();return l("manage_settings")?e.jsxs("div",{className:"space-y-6 tempo-52a214ae-ecc2-527d-b491-a3f54583f668",dir:"rtl",tempoelementid:"tempo-52a214ae-ecc2-527d-b491-a3f54583f668",children:[e.jsx(C,{title:"النسخ الاحتياطي واستعادة البيانات",description:"إنشاء نسخة احتياطية من بيانات النظام أو استعادة البيانات من نسخة احتياطية سابقة",className:"tempo-ae589cc0-2e7b-54ba-bf43-2ee80bffc094 ",tempoelementid:"tempo-ae589cc0-2e7b-54ba-bf43-2ee80bffc094"}),e.jsx(M,{className:"tempo-0beb36ad-3be5-54f6-bbfb-ec58db4c6f14 ",tempoelementid:"tempo-0beb36ad-3be5-54f6-bbfb-ec58db4c6f14"})]},"85895108237632627577671260289426891749-5"):e.jsxs("div",{className:"flex h-full flex-col items-center justify-center p-4 text-center tempo-79662f86-f98a-5cd6-bf98-dbbed7ed968b",tempoelementid:"tempo-79662f86-f98a-5cd6-bf98-dbbed7ed968b",children:[e.jsx("h1",{className:"text-2xl font-bold text-red-600 mb-2 tempo-d281db00-680a-5a5f-9780-d4f853466a31",tempoelementid:"tempo-d281db00-680a-5a5f-9780-d4f853466a31",children:"غير مصرح"},"85895108237632627577671260289426891749-2"),e.jsx("p",{className:"mb-4 tempo-42f21d03-c34b-5bc2-9a40-baea660fd6c3",tempoelementid:"tempo-42f21d03-c34b-5bc2-9a40-baea660fd6c3",children:"ليس لديك صلاحية للوصول إلى هذه الصفحة"},"85895108237632627577671260289426891749-3"),e.jsx(r,{onClick:()=>window.history.back(),className:"tempo-05397a61-6176-59ac-b8e3-030a5b0d4245 ",tempoelementid:"tempo-05397a61-6176-59ac-b8e3-030a5b0d4245",children:"العودة"})]},"85895108237632627577671260289426891749-1")}export{K as default};
