import{l as z,r as c,j as e,C as O,L as s,S as w,n as E,p as T,q as k,v as i,I as u,B as o,P as B,D as H,g as L,h as U,i as G,k as M}from"./index-DCzl8a2M.js";import{D as Q}from"./data-table-Dyk-SJUO.js";import{A as W,a as X,b as Y,c as Z,d as _,e as ee,f as ae,g as te}from"./alert-dialog-mt10r_ul.js";import{S as de}from"./square-pen-DyTrw8aF.js";import{T as ce}from"./trash-2-BU5t-Hxw.js";function pe(){const{employees:d}=z(),[f,g]=c.useState(""),[x,h]=c.useState(""),[N,j]=c.useState(""),[l,m]=c.useState([]);c.useEffect(()=>{const a=localStorage.getItem("advances");if(a)m(JSON.parse(a));else if(d.length>0){const t=[];d[0]&&(t.push({id:"1",employeeId:d[0].id,employeeName:d[0].name,amount:1e3,requestDate:"2024-05-01",expectedRepaymentDate:"2024-06-01",status:"pending",remainingAmount:1e3}),t.push({id:"3",employeeId:d[0].id,employeeName:d[0].name,amount:800,requestDate:"2024-05-10",expectedRepaymentDate:"2024-06-10",status:"pending",remainingAmount:800})),d[1]&&t.push({id:"2",employeeId:d[1].id,employeeName:d[1].name,amount:500,requestDate:"2024-04-15",expectedRepaymentDate:"2024-05-15",status:"paid",actualRepaymentDate:"2024-05-15",remainingAmount:0}),m(t),localStorage.setItem("advances",JSON.stringify(t))}},[d]);const[q,n]=c.useState(!1),[y,v]=c.useState(null),[K,b]=c.useState(!1),[D,S]=c.useState(null),[p,r]=c.useState("pending"),[A,C]=c.useState(""),J=a=>{a.preventDefault();const t=d.find($=>$.id===f);if(!t)return;const R={id:Date.now().toString(),employeeId:f,employeeName:t.name,amount:parseFloat(x),requestDate:new Date().toISOString().split("T")[0],expectedRepaymentDate:N,status:"pending"},I=[...l,R];m(I),localStorage.setItem("advances",JSON.stringify(I)),g(""),h(""),j("")},V=()=>{if(!y)return;const a=l.map(t=>t.id===y.id?{...t,status:p,actualRepaymentDate:p==="paid"?A:t.actualRepaymentDate}:t);m(a),localStorage.setItem("advances",JSON.stringify(a)),n(!1),v(null),r("pending"),C("")},P=()=>{if(!D)return;const a=l.filter(t=>t.id!==D);m(a),localStorage.setItem("advances",JSON.stringify(a)),b(!1),S(null)},F=[{accessorKey:"employeeName",header:"اسم الموظف"},{accessorKey:"amount",header:"المبلغ",cell:({row:a})=>`${a.getValue("amount")} ج.م`},{accessorKey:"requestDate",header:"تاريخ الطلب"},{accessorKey:"expectedRepaymentDate",header:"تاريخ السداد المتوقع"},{id:"remainingAmount",header:"المبلغ المتبقي",cell:({row:a})=>{const t=a.original;return`${t.remainingAmount!==void 0?t.remainingAmount:t.status==="paid"?0:t.amount} ج.م`}},{accessorKey:"status",header:"الحالة",cell:({row:a})=>{const t=a.getValue("status");return e.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${t==="paid"?"bg-green-100 text-green-800":t==="delayed"?"bg-red-100 text-red-800":"bg-yellow-100 text-yellow-800"} tempo-b20b4fea-b259-556b-b329-fd028e5cad42`,tempoelementid:"tempo-b20b4fea-b259-556b-b329-fd028e5cad42",children:t==="paid"?"مدفوعة":t==="delayed"?"مؤجلة":"قيد الانتظار"},"174267304392625803046697110256089364289-1")}},{id:"actualRepaymentDate",header:"تاريخ السداد الفعلي",cell:({row:a})=>a.original.actualRepaymentDate||"--"},{id:"actions",cell:({row:a})=>{const t=a.original;return e.jsxs("div",{className:"flex items-center justify-end gap-2 tempo-016fd15b-ed6f-58be-828a-e399d861e037",tempoelementid:"tempo-016fd15b-ed6f-58be-828a-e399d861e037",children:[e.jsx(o,{variant:"ghost",size:"icon",onClick:()=>{v(t),r(t.status),n(!0)},className:"tempo-a3f09f8b-b899-5ced-9fed-bed532c5774d ",tempoelementid:"tempo-a3f09f8b-b899-5ced-9fed-bed532c5774d",children:e.jsx(de,{className:"h-4 w-4 tempo-d873a0ad-7dc1-56b1-adc4-ee365758fb5b",tempoelementid:"tempo-d873a0ad-7dc1-56b1-adc4-ee365758fb5b"})}),e.jsx(o,{variant:"ghost",size:"icon",onClick:()=>{S(t.id),b(!0)},className:"tempo-26705b00-ddc3-5ec7-a498-6f36a2168d39 ",tempoelementid:"tempo-26705b00-ddc3-5ec7-a498-6f36a2168d39",children:e.jsx(ce,{className:"h-4 w-4 text-destructive tempo-b8b163a4-b18c-55d8-9d5d-c6e82a72e757",tempoelementid:"tempo-b8b163a4-b18c-55d8-9d5d-c6e82a72e757"})})]},"174267304392625803046697110256089364289-2")}}];return e.jsxs("div",{className:"space-y-6 tempo-bb4f9c05-5259-552b-88a8-d42c444bbb94",dir:"rtl",tempoelementid:"tempo-bb4f9c05-5259-552b-88a8-d42c444bbb94",children:[e.jsx("h1",{className:"text-3xl font-bold bg-gradient-to-l from-primary to-primary/70 bg-clip-text text-transparent inline-block tempo-238bee8d-24f5-5252-b55b-573c59ac081c",tempoelementid:"tempo-238bee8d-24f5-5252-b55b-573c59ac081c",children:"إدارة السلف"},"174267304392625803046697110256089364289-8"),e.jsxs(O,{className:"p-6 tempo-d8e43328-0c15-5cee-98a7-ff0431465564",tempoelementid:"tempo-d8e43328-0c15-5cee-98a7-ff0431465564",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4 tempo-d41f0ab4-3fb9-5081-b45a-c09c237d34dc",tempoelementid:"tempo-d41f0ab4-3fb9-5081-b45a-c09c237d34dc",children:"إضافة سلفة جديدة"},"174267304392625803046697110256089364289-10"),e.jsxs("form",{onSubmit:J,className:"space-y-4 tempo-efac18c9-cdf8-5a5c-8b14-2b3e20268029",tempoelementid:"tempo-efac18c9-cdf8-5a5c-8b14-2b3e20268029",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 tempo-171d952e-0f35-55e3-bee4-d420fa90abfe",tempoelementid:"tempo-171d952e-0f35-55e3-bee4-d420fa90abfe",children:[e.jsxs("div",{className:"space-y-2 tempo-3e20f832-ec42-5643-893a-39f8399b6e47",tempoelementid:"tempo-3e20f832-ec42-5643-893a-39f8399b6e47",children:[e.jsx(s,{className:"tempo-47bdd3f9-33b4-5c9f-8c58-459ec7f00d3b ",tempoelementid:"tempo-47bdd3f9-33b4-5c9f-8c58-459ec7f00d3b",children:"الموظف"}),e.jsxs(w,{value:f,onValueChange:g,className:"tempo-49c3489f-c904-5d1d-bec2-75818f910e89 ",tempoelementid:"tempo-49c3489f-c904-5d1d-bec2-75818f910e89",children:[e.jsx(E,{className:"tempo-8d415de7-9f8f-566a-89ff-b1250a48ecfe ",tempoelementid:"tempo-8d415de7-9f8f-566a-89ff-b1250a48ecfe",children:e.jsx(T,{placeholder:"اختر موظف",className:"tempo-ce624a00-9564-5757-a623-e8e9225c8a6a ",tempoelementid:"tempo-ce624a00-9564-5757-a623-e8e9225c8a6a"})}),e.jsx(k,{className:"tempo-528c9882-8453-54d0-9f72-21dce6234a53 ",tempoelementid:"tempo-528c9882-8453-54d0-9f72-21dce6234a53",children:d.map(a=>e.jsx(i,{value:a.id,className:"tempo-4b994607-4b1e-5002-8db2-9be2a3f36c9d ",tempoelementid:"tempo-4b994607-4b1e-5002-8db2-9be2a3f36c9d",children:a.name},a.id))})]})]},"174267304392625803046697110256089364289-13"),e.jsxs("div",{className:"space-y-2 tempo-53354662-9cb0-5b0d-aa1f-730247b16ad8",tempoelementid:"tempo-53354662-9cb0-5b0d-aa1f-730247b16ad8",children:[e.jsx(s,{className:"tempo-004e1d12-ecfd-5a6f-85a6-ae09b50f0d21 ",tempoelementid:"tempo-004e1d12-ecfd-5a6f-85a6-ae09b50f0d21",children:"مبلغ السلفة"}),e.jsx(u,{type:"number",value:x,onChange:a=>h(a.target.value),placeholder:"0",className:"text-right tempo-f735deb3-1cce-5e05-96d5-174983aef981",tempoelementid:"tempo-f735deb3-1cce-5e05-96d5-174983aef981"})]},"174267304392625803046697110256089364289-20"),e.jsxs("div",{className:"space-y-2 tempo-3f96786f-5e12-592f-ac60-263e1a0704b3",tempoelementid:"tempo-3f96786f-5e12-592f-ac60-263e1a0704b3",children:[e.jsx(s,{className:"tempo-9342492a-ee98-507c-ac3a-8ca69a1fe8c5 ",tempoelementid:"tempo-9342492a-ee98-507c-ac3a-8ca69a1fe8c5",children:"تاريخ السداد المتوقع"}),e.jsx(u,{type:"date",value:N,onChange:a=>j(a.target.value),className:"text-right tempo-f53ff751-9545-5b85-92f7-f3b5debacb98",tempoelementid:"tempo-f53ff751-9545-5b85-92f7-f3b5debacb98"})]},"174267304392625803046697110256089364289-23")]},"174267304392625803046697110256089364289-12"),e.jsx("div",{className:"flex justify-end tempo-e2ce809d-b7d2-5b89-aaa2-46b49bc0497c",tempoelementid:"tempo-e2ce809d-b7d2-5b89-aaa2-46b49bc0497c",children:e.jsxs(o,{type:"submit",className:"tempo-a38b23dd-267a-53a9-af8d-115c8132b64d ",tempoelementid:"tempo-a38b23dd-267a-53a9-af8d-115c8132b64d",children:[e.jsx(B,{className:"ml-2 h-4 w-4 tempo-d3f813dc-a218-53fe-8cb6-9241d716c2ca",tempoelementid:"tempo-d3f813dc-a218-53fe-8cb6-9241d716c2ca"}),"إضافة السلفة"]})},"174267304392625803046697110256089364289-26")]},"174267304392625803046697110256089364289-11")]}),e.jsxs(O,{className:"p-6 tempo-0a21f302-26f5-52aa-a856-74485ee269fb",tempoelementid:"tempo-0a21f302-26f5-52aa-a856-74485ee269fb",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4 tempo-eddd59eb-8942-578d-8565-3470da59e6b7",tempoelementid:"tempo-eddd59eb-8942-578d-8565-3470da59e6b7",children:"السلف الحالية"},"174267304392625803046697110256089364289-30"),e.jsx(Q,{columns:F,data:l,searchKey:"employeeName",className:"tempo-83e2319b-282d-50e4-97ec-9d01696254eb ",tempoelementid:"tempo-83e2319b-282d-50e4-97ec-9d01696254eb"})]}),e.jsx(H,{open:q,onOpenChange:n,className:"tempo-687d3774-b5c7-5d2f-8ca5-e1466126c7db ",tempoelementid:"tempo-687d3774-b5c7-5d2f-8ca5-e1466126c7db",children:e.jsxs(L,{dir:"rtl",className:"tempo-e57b9631-f257-57fc-ad55-3f36c3afda37 ",tempoelementid:"tempo-e57b9631-f257-57fc-ad55-3f36c3afda37",children:[e.jsx(U,{className:"tempo-d854c4c6-016d-586c-9659-ec04b1dfe340 ",tempoelementid:"tempo-d854c4c6-016d-586c-9659-ec04b1dfe340",children:e.jsx(G,{className:"tempo-c654faa0-e31a-5030-9cbf-94bfa405f64c ",tempoelementid:"tempo-c654faa0-e31a-5030-9cbf-94bfa405f64c",children:"تحديث حالة السلفة"})}),e.jsxs("div",{className:"space-y-4 py-4 tempo-aab7f642-79f4-5266-aa8a-9a0492957963",tempoelementid:"tempo-aab7f642-79f4-5266-aa8a-9a0492957963",children:[e.jsxs("div",{className:"space-y-2 tempo-553188d8-f8fc-5a21-941e-e37f18b00f72",tempoelementid:"tempo-553188d8-f8fc-5a21-941e-e37f18b00f72",children:[e.jsx(s,{className:"tempo-993c21a7-b641-5e8d-bdbc-f46714b9dca9 ",tempoelementid:"tempo-993c21a7-b641-5e8d-bdbc-f46714b9dca9",children:"الحالة"}),e.jsxs(w,{value:p,onValueChange:a=>r(a),className:"tempo-0a178785-6cda-5849-af7c-ac176e62165c ",tempoelementid:"tempo-0a178785-6cda-5849-af7c-ac176e62165c",children:[e.jsx(E,{className:"tempo-80cf4b8c-5e2c-51f6-a989-470555c5dced ",tempoelementid:"tempo-80cf4b8c-5e2c-51f6-a989-470555c5dced",children:e.jsx(T,{className:"tempo-cc480ba7-3e26-5728-be50-f128fe16bcc1 ",tempoelementid:"tempo-cc480ba7-3e26-5728-be50-f128fe16bcc1"})}),e.jsxs(k,{className:"tempo-e2b0c521-7bdf-5179-9155-c497f4c56f71 ",tempoelementid:"tempo-e2b0c521-7bdf-5179-9155-c497f4c56f71",children:[e.jsx(i,{value:"pending",className:"tempo-b8db1aa7-329f-5c05-83da-5c418d092490 ",tempoelementid:"tempo-b8db1aa7-329f-5c05-83da-5c418d092490",children:"قيد الانتظار"}),e.jsx(i,{value:"paid",className:"tempo-330c1409-3070-56c7-8f42-55282ec4a58b ",tempoelementid:"tempo-330c1409-3070-56c7-8f42-55282ec4a58b",children:"مدفوعة"}),e.jsx(i,{value:"delayed",className:"tempo-a436ed8a-a57f-5311-953d-3bfe27b039ae ",tempoelementid:"tempo-a436ed8a-a57f-5311-953d-3bfe27b039ae",children:"مؤجلة"})]})]})]},"174267304392625803046697110256089364289-37"),p==="paid"&&e.jsxs("div",{className:"space-y-2 tempo-d8b407b6-f6a8-50ec-a18f-ead5b081aa1f",tempoelementid:"tempo-d8b407b6-f6a8-50ec-a18f-ead5b081aa1f",children:[e.jsx(s,{className:"tempo-5876437b-71ed-5941-86ce-7d3e9aebe4b3 ",tempoelementid:"tempo-5876437b-71ed-5941-86ce-7d3e9aebe4b3",children:"تاريخ السداد الفعلي"}),e.jsx(u,{type:"date",value:A,onChange:a=>C(a.target.value),className:"text-right tempo-dc92429f-7bdc-5439-acb8-989975d15bc1",tempoelementid:"tempo-dc92429f-7bdc-5439-acb8-989975d15bc1"})]},"174267304392625803046697110256089364289-46")]},"174267304392625803046697110256089364289-36"),e.jsxs(M,{className:"gap-2 tempo-8d10e3b4-6084-573d-a541-983c6ca35f6b",tempoelementid:"tempo-8d10e3b4-6084-573d-a541-983c6ca35f6b",children:[e.jsx(o,{variant:"outline",onClick:()=>n(!1),className:"tempo-72cb8321-c1fa-5b02-b84f-29263f8f3a47 ",tempoelementid:"tempo-72cb8321-c1fa-5b02-b84f-29263f8f3a47",children:"إلغاء"}),e.jsx(o,{onClick:V,className:"tempo-6cb90fc1-696a-5948-bf83-b026ef60a6e4 ",tempoelementid:"tempo-6cb90fc1-696a-5948-bf83-b026ef60a6e4",children:"تحديث"})]})]})}),e.jsx(W,{open:K,onOpenChange:b,className:"tempo-db98cc28-3891-5428-bee3-0fcbe7f0228c ",tempoelementid:"tempo-db98cc28-3891-5428-bee3-0fcbe7f0228c",children:e.jsxs(X,{dir:"rtl",className:"tempo-5d8d7e61-3cd8-577d-a0a7-00a0d08947e1 ",tempoelementid:"tempo-5d8d7e61-3cd8-577d-a0a7-00a0d08947e1",children:[e.jsxs(Y,{className:"tempo-600a7ff6-7a44-58b8-b2ca-641e8b0c4363 ",tempoelementid:"tempo-600a7ff6-7a44-58b8-b2ca-641e8b0c4363",children:[e.jsx(Z,{className:"tempo-6d3b3a39-47b2-5656-9007-21989dd66304 ",tempoelementid:"tempo-6d3b3a39-47b2-5656-9007-21989dd66304",children:"هل أنت متأكد من حذف هذه السلفة؟"}),e.jsx(_,{className:"tempo-8095ba70-0b78-5a5b-bfdb-6a51391f0efb ",tempoelementid:"tempo-8095ba70-0b78-5a5b-bfdb-6a51391f0efb",children:"هذا الإجراء لا يمكن التراجع عنه. سيتم حذف بيانات السلفة بشكل دائم."})]}),e.jsxs(ee,{className:"flex-row-reverse justify-start gap-2 tempo-7f1caf50-78a2-57b0-b6f2-e57c855980e2",tempoelementid:"tempo-7f1caf50-78a2-57b0-b6f2-e57c855980e2",children:[e.jsx(ae,{className:"tempo-26ae732d-cef0-53a6-98db-3df6ef0e3d35 ",tempoelementid:"tempo-26ae732d-cef0-53a6-98db-3df6ef0e3d35",children:"إلغاء"}),e.jsx(te,{onClick:P,className:"bg-destructive hover:bg-destructive/90 tempo-f3e07fe4-9f82-576e-bef0-7d26df2a89d7",tempoelementid:"tempo-f3e07fe4-9f82-576e-bef0-7d26df2a89d7",children:"حذف"})]})]})})]},"174267304392625803046697110256089364289-7")}export{pe as default};
