import{e as t}from"./index-DCzl8a2M.js";async function c(r){var a,n;if(!t||!r)return null;try{const{data:e,error:i}=await t.from("users").select("*").eq("id",r.id).single();if(i&&i.code==="PGRST116"){const{data:o,error:l}=await t.from("users").insert([{id:r.id,email:r.email,name:((a=r.user_metadata)==null?void 0:a.name)||r.email.split("@")[0],role:((n=r.user_metadata)==null?void 0:n.role)||"viewer",is_active:!0,created_at:new Date().toISOString()}]).select().single();return l?(console.error("Error creating user in public table:",l),null):o}return e}catch(e){return console.error("Error in ensureUserInPublicTable:",e),null}}export{c as ensureUserInPublicTable};
