import{f as F,e as o,a8 as x,o as Y,s as S,a9 as ee,aa as ae,ab as te,ac as se,b as ce,r as b,u as re,c as oe,t as de,j as e,B as w,U as ie,ad as me,I as E,C as ne,d as P,D as le,g as fe,h as pe,i as be,a0 as ue,L as g,S as he,n as ge,p as xe,q as ve,v as C,k as we,m as q,a7 as je}from"./index-DCzl8a2M.js";import{D as Ne}from"./data-table-Dyk-SJUO.js";import{A as ye,a as Se,b as Ee,c as _e,d as Ue,e as ke,f as Ce,g as De}from"./alert-dialog-mt10r_ul.js";import{a as _}from"./auth-service-CPjkIBTZ.js";import{S as $e}from"./switch-DOvaJDyc.js";import{S as Ae}from"./square-pen-DyTrw8aF.js";import{T as Te}from"./trash-2-BU5t-Hxw.js";/**
 * @license lucide-react v0.394.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ze=F("EyeOff",[["path",{d:"M9.88 9.88a3 3 0 1 0 4.24 4.24",key:"1jxqfv"}],["path",{d:"M10.73 5.08A10.43 10.43 0 0 1 12 5c7 0 10 7 10 7a13.16 13.16 0 0 1-1.67 2.68",key:"9wicm4"}],["path",{d:"M6.61 6.61A13.526 13.526 0 0 0 2 12s3 7 10 7a9.74 9.74 0 0 0 5.39-1.61",key:"1jreej"}],["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}]]);/**
 * @license lucide-react v0.394.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Le=F("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),D={async signUp(c,t,r){try{if(!o)throw new Error("Supabase not initialized");const{data:i,error:n}=await o.auth.signUp({email:c,password:t,options:{data:{name:r.name,role:r.role||"viewer",avatar:r.avatar}}});if(n)throw n;if(i.user){const{error:v}=await o.from("users").insert([{id:i.user.id,email:c,name:r.name,role:r.role||"viewer",is_active:r.is_active!==!1,created_at:new Date().toISOString()}]);v&&console.error("Error creating user profile:",v)}return{success:!0,user:i.user}}catch(i){return console.error("Sign up error:",i),{success:!1,message:`Error creating user: ${i instanceof Error?i.message:String(i)}`}}},async signIn(c,t){try{if(!o)throw new Error("Supabase not initialized");const{data:r,error:i}=await o.auth.signInWithPassword({email:c,password:t});if(i)throw i;if(r.user){const{data:n,error:v}=await o.from("users").select("*").eq("id",r.user.id).single();if(!v&&n)return await o.from("users").update({last_login:new Date().toISOString(),login_count:(n.login_count||0)+1}).eq("id",n.id),x("auth","login","تسجيل دخول",n.id),{success:!0,user:{id:n.id,email:n.email,name:n.name,role:n.role,avatar:n.avatar,permissions:n.permissions}}}return{success:!0,user:r.user}}catch(r){return console.error("Sign in error:",r),{success:!1,message:`Error signing in: ${r instanceof Error?r.message:String(r)}`}}},async signOut(c){try{if(!o)throw new Error("Supabase not initialized");c&&x("auth","logout","تسجيل خروج",c);const{error:t}=await o.auth.signOut();if(t)throw t;return{success:!0}}catch(t){return console.error("Sign out error:",t),{success:!1,message:`Error signing out: ${t instanceof Error?t.message:String(t)}`}}},async getSession(){try{if(!o)throw new Error("Supabase not initialized");const{data:c,error:t}=await o.auth.getSession();if(t)throw t;return{success:!0,session:c.session}}catch(c){return console.error("Get session error:",c),{success:!1,session:null}}},async getUserById(c){try{if(!o)throw new Error("Supabase not initialized");const{data:t,error:r}=await o.from("users").select("*").eq("id",c).single();if(r)throw r;return{success:!0,user:t}}catch(t){return console.error("Get user error:",t),{success:!1,user:null}}},async updateUser(c,t){try{if(!o)throw new Error("Supabase not initialized");const{error:r}=await o.auth.updateUser({data:{name:t.name,role:t.role,avatar:t.avatar}});if(r)throw r;const{error:i}=await o.from("users").update({name:t.name,role:t.role,is_active:t.is_active,avatar:t.avatar,permissions:t.permissions,updated_at:new Date().toISOString()}).eq("id",c);if(i)throw i;return{success:!0}}catch(r){return console.error("Update user error:",r),{success:!1,message:`Error updating user: ${r instanceof Error?r.message:String(r)}`}}},async deleteUser(c){try{if(!o)throw new Error("Supabase not initialized");const{error:t}=await o.from("users").delete().eq("id",c);if(t)throw t;return{success:!0}}catch(t){return console.error("Delete user error:",t),{success:!1,message:`Error deleting user: ${t instanceof Error?t.message:String(t)}`}}},async getUsers(){try{if(!o)throw new Error("Supabase not initialized");const{data:c,error:t}=await o.from("users").select("*");if(t)throw t;return{success:!0,users:c}}catch(c){return console.error("Get users error:",c),{success:!1,users:[]}}},async resetPassword(c){try{if(!o)throw new Error("Supabase not initialized");const{error:t}=await o.auth.resetPasswordForEmail(c,{redirectTo:`${window.location.origin}/reset-password`});if(t)throw t;return{success:!0}}catch(t){return console.error("Reset password error:",t),{success:!1,message:`Error resetting password: ${t instanceof Error?t.message:String(t)}`}}},async updatePassword(c){try{if(!o)throw new Error("Supabase not initialized");const{error:t}=await o.auth.updateUser({password:c});if(t)throw t;return{success:!0}}catch(t){return console.error("Update password error:",t),{success:!1,message:`Error updating password: ${t instanceof Error?t.message:String(t)}`}}}},Oe=Y({name:S().min(3,"الاسم مطلوب"),email:S().email("البريد الإلكتروني غير صالح"),role:ee(["admin","manager","accountant","viewer"]),password:S().min(6,"كلمة المرور يجب أن تكون 6 أحرف على الأقل").optional().or(ae("")),is_active:te().optional(),avatar:S().optional(),permissions:se(S()).optional()});function Ie(){const{user:c,hasPermission:t}=ce(),[r,i]=b.useState([]),[n,v]=b.useState(!0),[K,j]=b.useState(!1),[l,z]=b.useState(null),[V,$]=b.useState(!1),[N,L]=b.useState(null),[A,O]=b.useState(!1),[T,G]=b.useState(""),{toast:f}=re(),{register:U,handleSubmit:M,reset:I,setValue:p,watch:y,formState:{errors:u}}=oe({resolver:de(Oe),defaultValues:{name:"",email:"",role:"viewer",password:"",is_active:!0,avatar:"",permissions:[]}}),k=async()=>{v(!0);try{if(o){const{success:a,users:s}=await D.getUsers();a?i(s):f({title:"خطأ",description:"فشل في جلب المستخدمين",variant:"destructive"})}else{const a=await _.getUsers();a.success?i(a.users):(console.error("Error fetching users:",a.message),f({title:"خطأ",description:a.message,variant:"destructive"}))}}catch(a){console.error("Error fetching users:",a)}finally{v(!1)}};b.useEffect(()=>{k()},[]);const B=a=>{z(a),p("name",a.name),p("email",a.email),p("role",a.role),p("password",""),p("is_active",a.is_active!==!1),p("avatar",a.avatar||""),p("permissions",a.permissions||[]),j(!0)},H=()=>{z(null),I({name:"",email:"",role:"viewer",password:"",is_active:!0,avatar:"",permissions:[]}),j(!0)},R=async a=>{if(c){O(!0);try{let s;o?l?(s=await D.updateUser(l.id,{name:a.name,role:a.role,is_active:a.is_active,avatar:a.avatar,permissions:a.permissions}),a.password&&console.log("Would update password for user",l.id),s.success&&(x("setting","update",`تم تحديث بيانات المستخدم ${a.name}`,c.id,{userId:l.id}),f({title:"تم التحديث بنجاح",description:"تم تحديث بيانات المستخدم بنجاح"}))):(s=await D.signUp(a.email,a.password||"password123",{name:a.name,role:a.role,is_active:a.is_active,avatar:a.avatar,permissions:a.permissions}),s.success&&(x("setting","create",`تم إنشاء مستخدم جديد ${a.name}`,c.id),f({title:"تم الإنشاء بنجاح",description:"تم إنشاء المستخدم الجديد بنجاح"}))):l?(s=await _.updateUser(l.id,{name:a.name,role:a.role,password:a.password||void 0,is_active:a.is_active,avatar:a.avatar,permissions:a.permissions}),s.success&&(x("setting","update",`تم تحديث بيانات المستخدم ${a.name}`,c.id,{userId:l.id}),f({title:"تم التحديث بنجاح",description:"تم تحديث بيانات المستخدم بنجاح"}))):(s=await _.createUser({email:a.email,password:a.password||"password123",name:a.name,role:a.role,is_active:a.is_active,avatar:a.avatar,permissions:a.permissions}),s.success&&(x("setting","create",`تم إنشاء مستخدم جديد ${a.name}`,c.id),f({title:"تم الإنشاء بنجاح",description:"تم إنشاء المستخدم الجديد بنجاح"}))),s&&s.success?(k(),j(!1),I()):s&&f({title:"خطأ",description:s.message,variant:"destructive"})}catch(s){console.error("Error saving user:",s),f({title:"خطأ",description:`حدث خطأ أثناء حفظ المستخدم: ${s instanceof Error?s.message:"خطأ غير معروف"}`,variant:"destructive"})}finally{O(!1)}}},Q=async()=>{var a;if(!(!N||!c))try{const s=((a=r.find(m=>m.id===N))==null?void 0:a.name)||"";let d;o?d=await D.deleteUser(N):d=await _.deleteUser(N),d.success?(x("setting","delete",`تم حذف المستخدم ${s}`,c.id,{userId:N}),f({title:"تم الحذف بنجاح",description:"تم حذف المستخدم بنجاح"}),k(),$(!1),L(null)):f({title:"خطأ",description:d.message,variant:"destructive"})}catch(s){console.error("Error deleting user:",s),f({title:"خطأ",description:`حدث خطأ أثناء حذف المستخدم: ${s instanceof Error?s.message:"خطأ غير معروف"}`,variant:"destructive"})}},W=async(a,s)=>{if(c)try{const d=r.find(h=>h.id===a);if(!d)return;const m=await _.updateUser(a,{is_active:!s});m.success?(x("setting","update",`تم ${s?"تعطيل":"تفعيل"} المستخدم ${d.name}`,c.id,{userId:a}),f({title:"تم التحديث بنجاح",description:`تم ${s?"تعطيل":"تفعيل"} المستخدم بنجاح`}),k()):f({title:"خطأ",description:m.message,variant:"destructive"})}catch(d){console.error("Error toggling user status:",d),f({title:"خطأ",description:`حدث خطأ أثناء تحديث حالة المستخدم: ${d instanceof Error?d.message:"خطأ غير معروف"}`,variant:"destructive"})}},Z=r.filter(a=>{if(!T)return!0;const s=T.toLowerCase();return a.name.toLowerCase().includes(s)||a.email.toLowerCase().includes(s)||a.role.toLowerCase().includes(s)}),J=[{accessorKey:"name",header:"الاسم",cell:({row:a})=>{const s=a.original;return e.jsxs("div",{className:"flex items-center gap-2 tempo-5b0d3815-40a5-5cb8-bd63-74c4afbd2ef4",tempoelementid:"tempo-5b0d3815-40a5-5cb8-bd63-74c4afbd2ef4",children:[e.jsx("div",{className:"h-8 w-8 rounded-full overflow-hidden tempo-6c942da8-9ecc-55e4-944b-9e456309c365",tempoelementid:"tempo-6c942da8-9ecc-55e4-944b-9e456309c365",children:e.jsx("img",{src:s.avatar||`https://api.dicebear.com/7.x/avataaars/svg?seed=${s.name}`,alt:s.name,className:"h-full w-full object-cover tempo-6e830d0c-5cd9-5714-99b0-c835459d2871",tempoelementid:"tempo-6e830d0c-5cd9-5714-99b0-c835459d2871"},"269756607046587511518193056830416328266-3")},"269756607046587511518193056830416328266-2"),e.jsx("span",{className:"tempo-a4141ece-3a4a-59c6-ab28-1c227cb07867 ",tempoelementid:"tempo-a4141ece-3a4a-59c6-ab28-1c227cb07867",children:s.name},"269756607046587511518193056830416328266-4")]},"269756607046587511518193056830416328266-1")}},{accessorKey:"email",header:"البريد الإلكتروني"},{accessorKey:"role",header:"الدور",cell:({row:a})=>{const s=a.getValue("role");let d="",m="";switch(s){case"admin":d="bg-red-100 text-red-800",m="مدير النظام";break;case"manager":d="bg-blue-100 text-blue-800",m="مدير";break;case"accountant":d="bg-green-100 text-green-800",m="محاسب";break;case"viewer":d="bg-gray-100 text-gray-800",m="مستخدم عادي";break}return e.jsx(q,{className:d+" tempo-254c6391-c262-595b-8964-a145148927e1",tempoelementid:"tempo-254c6391-c262-595b-8964-a145148927e1",children:m})}},{accessorKey:"is_active",header:"الحالة",cell:({row:a})=>{const s=a.original.is_active!==!1;return e.jsx(q,{className:(s?"bg-green-100 text-green-800":"bg-red-100 text-red-800")+" tempo-51cbceb2-fc6f-5ddd-9e92-05d674d4ad2c",tempoelementid:"tempo-51cbceb2-fc6f-5ddd-9e92-05d674d4ad2c",children:s?"نشط":"معطل"})}},{accessorKey:"last_login",header:"آخر تسجيل دخول",cell:({row:a})=>{const s=a.original.last_login;if(!s)return"لم يسجل الدخول بعد";const d=new Date(s);return d.toLocaleDateString("ar-EG")+" "+d.toLocaleTimeString("ar-EG")}},{accessorKey:"created_at",header:"تاريخ الإنشاء",cell:({row:a})=>new Date(a.getValue("created_at")).toLocaleDateString("ar-EG")},{id:"actions",header:"الإجراءات",cell:({row:a})=>{const s=a.original,d=(c==null?void 0:c.id)===s.id,m=(c==null?void 0:c.role)==="admin",h=s.is_active!==!1;return e.jsxs("div",{className:"flex items-center justify-end gap-2 tempo-a51ed840-4ece-58ad-bd4c-a97a61053e30",tempoelementid:"tempo-a51ed840-4ece-58ad-bd4c-a97a61053e30",children:[e.jsx(w,{variant:"ghost",size:"sm",onClick:()=>W(s.id,h),disabled:!m||d,title:h?"تعطيل المستخدم":"تفعيل المستخدم",className:"tempo-d74f154e-a3f4-5360-834b-4b81f2a38ee3 ",tempoelementid:"tempo-d74f154e-a3f4-5360-834b-4b81f2a38ee3",children:h?e.jsx(ze,{className:"h-4 w-4 tempo-62b797aa-1d70-5a2c-a710-0b6fa8249b86",tempoelementid:"tempo-62b797aa-1d70-5a2c-a710-0b6fa8249b86"}):e.jsx(Le,{className:"h-4 w-4 tempo-84c129ea-7939-5a53-8cdc-eaf2f08856e8",tempoelementid:"tempo-84c129ea-7939-5a53-8cdc-eaf2f08856e8"})}),e.jsx(w,{variant:"ghost",size:"sm",onClick:()=>B(s),disabled:!m&&!d,title:"تعديل المستخدم",className:"tempo-8db67f8e-47cc-5810-bdd2-46c1f1d030e2 ",tempoelementid:"tempo-8db67f8e-47cc-5810-bdd2-46c1f1d030e2",children:e.jsx(Ae,{className:"h-4 w-4 tempo-8b0dd8ed-b576-5524-a280-6de8d94ddb13",tempoelementid:"tempo-8b0dd8ed-b576-5524-a280-6de8d94ddb13"})}),e.jsx(w,{variant:"ghost",size:"sm",className:"text-destructive hover:bg-destructive/10 tempo-61af501a-b862-54b1-bcbc-cf2e2fdf1a38",onClick:()=>{L(s.id),$(!0)},disabled:!m||d,title:"حذف المستخدم",tempoelementid:"tempo-61af501a-b862-54b1-bcbc-cf2e2fdf1a38",children:e.jsx(Te,{className:"h-4 w-4 tempo-60003bc7-e493-5877-8ff6-c9ee88e1deae",tempoelementid:"tempo-60003bc7-e493-5877-8ff6-c9ee88e1deae"})})]},"269756607046587511518193056830416328266-7")}}];return t("manage_users")?e.jsxs("div",{className:"space-y-6 tempo-8fa21ad1-90fe-512a-9be1-cb13a4a67854",tempoelementid:"tempo-8fa21ad1-90fe-512a-9be1-cb13a4a67854",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4 mb-6 tempo-d0c01f3e-3da6-54bb-943f-2dedabab235e",tempoelementid:"tempo-d0c01f3e-3da6-54bb-943f-2dedabab235e",children:[e.jsxs("div",{className:"tempo-7d26846f-7ba0-5581-bce1-428b9900983f ",tempoelementid:"tempo-7d26846f-7ba0-5581-bce1-428b9900983f",children:[e.jsx("h2",{className:"text-2xl font-bold bg-gradient-to-l from-primary to-primary/70 bg-clip-text text-transparent inline-block mb-2 tempo-731baffd-5f84-597b-9a24-f36fe16002da",tempoelementid:"tempo-731baffd-5f84-597b-9a24-f36fe16002da",children:"إدارة المستخدمين"},"269756607046587511518193056830416328266-22"),e.jsx("p",{className:"text-muted-foreground tempo-f446357a-b65d-5a05-b556-3b316fbff788",tempoelementid:"tempo-f446357a-b65d-5a05-b556-3b316fbff788",children:"إضافة وتعديل وحذف المستخدمين وإدارة الصلاحيات"},"269756607046587511518193056830416328266-23")]},"269756607046587511518193056830416328266-21"),e.jsxs(w,{onClick:H,className:"shadow-sm hover:shadow-md transition-all duration-300 tempo-07144667-d9fd-5fd3-a4ab-111269d19325",tempoelementid:"tempo-07144667-d9fd-5fd3-a4ab-111269d19325",children:[e.jsx(ie,{className:"ml-2 h-4 w-4 tempo-d7789d35-5ff5-5ca7-ad7b-74d6f54916d7",tempoelementid:"tempo-d7789d35-5ff5-5ca7-ad7b-74d6f54916d7"}),"إضافة مستخدم جديد"]})]},"269756607046587511518193056830416328266-20"),e.jsx("div",{className:"flex items-center mb-4 tempo-3eae0132-44b7-5003-9e55-d76407b632d1",tempoelementid:"tempo-3eae0132-44b7-5003-9e55-d76407b632d1",children:e.jsxs("div",{className:"relative flex-1 max-w-sm tempo-f9d600f4-4051-53c9-978c-23555bedccf3",tempoelementid:"tempo-f9d600f4-4051-53c9-978c-23555bedccf3",children:[e.jsx(me,{className:"absolute right-3 top-2.5 h-4 w-4 text-muted-foreground tempo-99d3144e-d741-5d65-8d44-e72cd6cdd091",tempoelementid:"tempo-99d3144e-d741-5d65-8d44-e72cd6cdd091"}),e.jsx(E,{placeholder:"بحث عن مستخدم...",value:T,onChange:a=>G(a.target.value),className:"pl-3 pr-9 tempo-b9b44bdd-ed54-55ac-8d6d-c1a9841dd24a",tempoelementid:"tempo-b9b44bdd-ed54-55ac-8d6d-c1a9841dd24a"})]},"269756607046587511518193056830416328266-27")},"269756607046587511518193056830416328266-26"),e.jsx(ne,{className:"p-6 tempo-524baad7-3260-5f0a-9522-193d810c6c56",tempoelementid:"tempo-524baad7-3260-5f0a-9522-193d810c6c56",children:n?e.jsxs("div",{className:"flex justify-center p-8 tempo-d79f1f6e-e55a-5705-88f1-d78dca2d39a8",tempoelementid:"tempo-d79f1f6e-e55a-5705-88f1-d78dca2d39a8",children:[e.jsx(P,{size:"lg",className:"tempo-d4d141e5-7093-5094-adf5-941055ec9712 ",tempoelementid:"tempo-d4d141e5-7093-5094-adf5-941055ec9712"}),e.jsx("span",{className:"mr-2 tempo-a4600cdc-50b4-53d7-bbaa-14e9c71547ce",tempoelementid:"tempo-a4600cdc-50b4-53d7-bbaa-14e9c71547ce",children:"جاري التحميل..."},"269756607046587511518193056830416328266-33")]},"269756607046587511518193056830416328266-31"):e.jsx(Ne,{columns:J,data:Z,searchKey:"name",className:"tempo-2cc0686e-9555-5caf-9c53-342c8778a2b9 ",tempoelementid:"tempo-2cc0686e-9555-5caf-9c53-342c8778a2b9"})}),e.jsx(le,{open:K,onOpenChange:j,className:"tempo-d4b6a406-c1aa-5896-9125-d6ead0b2c145 ",tempoelementid:"tempo-d4b6a406-c1aa-5896-9125-d6ead0b2c145",children:e.jsxs(fe,{className:"sm:max-w-[425px] tempo-3de870a3-c508-57ae-a2d2-c8886fbde5d2",dir:"rtl",tempoelementid:"tempo-3de870a3-c508-57ae-a2d2-c8886fbde5d2",children:[e.jsxs(pe,{className:"tempo-2ccfe65b-aa49-5a38-9c03-f30e37cc28d3 ",tempoelementid:"tempo-2ccfe65b-aa49-5a38-9c03-f30e37cc28d3",children:[e.jsx(be,{className:"tempo-a6f39c21-664b-5c41-a754-05776218f6e8 ",tempoelementid:"tempo-a6f39c21-664b-5c41-a754-05776218f6e8",children:l?"تعديل بيانات المستخدم":"إضافة مستخدم جديد"}),e.jsx(ue,{className:"tempo-f7937911-f871-5ac8-b6a2-5db6369af833 ",tempoelementid:"tempo-f7937911-f871-5ac8-b6a2-5db6369af833",children:l?"قم بتعديل بيانات المستخدم":"قم بإدخال بيانات المستخدم الجديد"})]}),e.jsxs("form",{onSubmit:M(R),className:"space-y-4 tempo-6a3b698d-d7b7-5697-a4b3-7d4f7f2f32f2",tempoelementid:"tempo-6a3b698d-d7b7-5697-a4b3-7d4f7f2f32f2",children:[e.jsxs("div",{className:"space-y-2 tempo-990d0777-1140-5f86-bcc8-40d3e1282f82",tempoelementid:"tempo-990d0777-1140-5f86-bcc8-40d3e1282f82",children:[e.jsx(g,{className:"tempo-e27bb062-4f0e-586f-8cec-bc7e2831c7f8 ",tempoelementid:"tempo-e27bb062-4f0e-586f-8cec-bc7e2831c7f8",children:"الاسم"}),e.jsx(E,{...U("name"),className:"text-right tempo-fadcd498-60d3-5eba-ab9d-377686ac038a",tempoelementid:"tempo-fadcd498-60d3-5eba-ab9d-377686ac038a"}),u.name&&e.jsx("p",{className:"text-sm text-red-500 tempo-ff455aa8-3111-563e-b3bb-d55c592efaaf",tempoelementid:"tempo-ff455aa8-3111-563e-b3bb-d55c592efaaf",children:u.name.message},"269756607046587511518193056830416328266-44")]},"269756607046587511518193056830416328266-41"),e.jsxs("div",{className:"space-y-2 tempo-04e35cee-e735-547b-b075-c62a7cce15a4",tempoelementid:"tempo-04e35cee-e735-547b-b075-c62a7cce15a4",children:[e.jsx(g,{className:"tempo-b27883f3-1180-5918-8036-b67e0c7024b1 ",tempoelementid:"tempo-b27883f3-1180-5918-8036-b67e0c7024b1",children:"البريد الإلكتروني"}),e.jsx(E,{...U("email"),className:"text-right tempo-63d1b981-f7a7-582c-9ef2-3d768da198f0",disabled:!!l,dir:"ltr",tempoelementid:"tempo-63d1b981-f7a7-582c-9ef2-3d768da198f0"}),u.email&&e.jsx("p",{className:"text-sm text-red-500 tempo-7ab3f95b-bfa6-587c-aa98-a76c27c5678f",tempoelementid:"tempo-7ab3f95b-bfa6-587c-aa98-a76c27c5678f",children:u.email.message},"269756607046587511518193056830416328266-48")]},"269756607046587511518193056830416328266-45"),e.jsxs("div",{className:"space-y-2 tempo-09cd7475-0f32-59fd-a096-a877f5ad7e1f",tempoelementid:"tempo-09cd7475-0f32-59fd-a096-a877f5ad7e1f",children:[e.jsx(g,{className:"tempo-579d5e95-ab3f-55a6-b243-9fe11a28fbb9 ",tempoelementid:"tempo-579d5e95-ab3f-55a6-b243-9fe11a28fbb9",children:"الدور"}),e.jsxs(he,{defaultValue:(l==null?void 0:l.role)||"viewer",onValueChange:a=>p("role",a),className:"tempo-a036b386-9fb3-5837-bc65-893cbd77cab5 ",tempoelementid:"tempo-a036b386-9fb3-5837-bc65-893cbd77cab5",children:[e.jsx(ge,{className:"tempo-03b6599a-ae6f-5a41-9ad9-1a58e2ea5b8a ",tempoelementid:"tempo-03b6599a-ae6f-5a41-9ad9-1a58e2ea5b8a",children:e.jsx(xe,{className:"tempo-945e8776-4489-53fc-b8d9-ef553fe83192 ",tempoelementid:"tempo-945e8776-4489-53fc-b8d9-ef553fe83192"})}),e.jsxs(ve,{className:"tempo-f29de3d7-8017-507c-96ec-47865e6949d0 ",tempoelementid:"tempo-f29de3d7-8017-507c-96ec-47865e6949d0",children:[e.jsx(C,{value:"admin",className:"tempo-34cb3979-7a9f-5f93-b40d-56c417a5888f ",tempoelementid:"tempo-34cb3979-7a9f-5f93-b40d-56c417a5888f",children:"مدير النظام"}),e.jsx(C,{value:"manager",className:"tempo-eb63ced5-0f8a-5c98-9b65-c179a4fcc47b ",tempoelementid:"tempo-eb63ced5-0f8a-5c98-9b65-c179a4fcc47b",children:"مدير"}),e.jsx(C,{value:"accountant",className:"tempo-9ad95fdb-834f-5c8a-a9f8-3e34aa50405f ",tempoelementid:"tempo-9ad95fdb-834f-5c8a-a9f8-3e34aa50405f",children:"محاسب"}),e.jsx(C,{value:"viewer",className:"tempo-a32286a7-8225-5630-a175-6aa57067bbd6 ",tempoelementid:"tempo-a32286a7-8225-5630-a175-6aa57067bbd6",children:"مستخدم عادي"})]})]}),u.role&&e.jsx("p",{className:"text-sm text-red-500 tempo-750256a1-ec3a-5969-8015-fdc7b9ac3dbe",tempoelementid:"tempo-750256a1-ec3a-5969-8015-fdc7b9ac3dbe",children:u.role.message},"269756607046587511518193056830416328266-59")]},"269756607046587511518193056830416328266-49"),e.jsxs("div",{className:"space-y-2 tempo-c183762c-d1bc-55cf-a2db-c804d0c822da",tempoelementid:"tempo-c183762c-d1bc-55cf-a2db-c804d0c822da",children:[e.jsx(g,{className:"tempo-9a3cc589-11b9-5d46-a75d-d34309a7879b ",tempoelementid:"tempo-9a3cc589-11b9-5d46-a75d-d34309a7879b",children:l?"كلمة المرور الجديدة (اختياري)":"كلمة المرور"}),e.jsx(E,{...U("password"),type:"password",className:"text-right tempo-5d8b5c80-8ee9-5061-b90b-f9d4e961f704",dir:"ltr",tempoelementid:"tempo-5d8b5c80-8ee9-5061-b90b-f9d4e961f704"}),u.password&&e.jsx("p",{className:"text-sm text-red-500 tempo-84ebbaac-8455-50c4-b215-0a796276171b",tempoelementid:"tempo-84ebbaac-8455-50c4-b215-0a796276171b",children:u.password.message},"269756607046587511518193056830416328266-63")]},"269756607046587511518193056830416328266-60"),e.jsxs("div",{className:"space-y-2 tempo-79f794b5-b547-5e4f-9d96-2a063ad45471",tempoelementid:"tempo-79f794b5-b547-5e4f-9d96-2a063ad45471",children:[e.jsx(g,{className:"tempo-d33a78c1-9a3c-508c-8a21-92a5fb4a8b3b ",tempoelementid:"tempo-d33a78c1-9a3c-508c-8a21-92a5fb4a8b3b",children:"صورة المستخدم (URL)"}),e.jsx(E,{...U("avatar"),placeholder:"https://example.com/avatar.jpg",className:"text-right tempo-50e88561-4bf5-58f1-8a0f-effe8b903c71",dir:"ltr",tempoelementid:"tempo-50e88561-4bf5-58f1-8a0f-effe8b903c71"}),e.jsx("div",{className:"flex justify-center mt-2 tempo-ec397b9f-4816-5b55-a577-0c7c11ad5d9a",tempoelementid:"tempo-ec397b9f-4816-5b55-a577-0c7c11ad5d9a",children:e.jsx("div",{className:"h-16 w-16 rounded-full overflow-hidden border tempo-110291e8-d801-53a9-9d18-c53fc3a7f1b5",tempoelementid:"tempo-110291e8-d801-53a9-9d18-c53fc3a7f1b5",children:e.jsx("img",{src:y("avatar")||`https://api.dicebear.com/7.x/avataaars/svg?seed=${y("name")}`,alt:"صورة المستخدم",className:"h-full w-full object-cover tempo-e959bca4-5bfa-5805-ad5d-c66f4b62917a",tempoelementid:"tempo-e959bca4-5bfa-5805-ad5d-c66f4b62917a"},"269756607046587511518193056830416328266-69")},"269756607046587511518193056830416328266-68")},"269756607046587511518193056830416328266-67")]},"269756607046587511518193056830416328266-64"),e.jsxs("div",{className:"space-y-2 tempo-9efb35c1-4388-5a3a-95df-ef817a96812b",tempoelementid:"tempo-9efb35c1-4388-5a3a-95df-ef817a96812b",children:[e.jsx(g,{className:"tempo-0cdf2c9c-0c4c-5fb8-b977-a3d0f730f5ef ",tempoelementid:"tempo-0cdf2c9c-0c4c-5fb8-b977-a3d0f730f5ef",children:"الصلاحيات"}),e.jsx("div",{className:"grid grid-cols-2 gap-2 border rounded-md p-3 tempo-0cbba3fc-72f6-5ada-8fb3-36ef61c09d64",tempoelementid:"tempo-0cbba3fc-72f6-5ada-8fb3-36ef61c09d64",children:[{id:"view_dashboard",label:"عرض لوحة التحكم"},{id:"manage_employees",label:"إدارة الموظفين"},{id:"manage_salaries",label:"إدارة الرواتب"},{id:"manage_advances",label:"إدارة السلف"},{id:"manage_attendance",label:"إدارة الحضور"},{id:"view_reports",label:"عرض التقارير"},{id:"export_data",label:"تصدير البيانات"},{id:"manage_settings",label:"إدارة الإعدادات"},{id:"manage_users",label:"إدارة المستخدمين"}].map(a=>{const d=(y("permissions")||[]).includes(a.id);return e.jsxs("div",{className:"flex items-center space-x-2 space-x-reverse tempo-2963899c-d1a4-5678-85de-d1743198ba2f",tempoelementid:"tempo-2963899c-d1a4-5678-85de-d1743198ba2f",children:[e.jsx("input",{type:"checkbox",id:`permission-${a.id}`,checked:d,onChange:m=>{const h=[...y("permissions")||[]];m.target.checked?p("permissions",[...h,a.id]):p("permissions",h.filter(X=>X!==a.id))},className:"h-4 w-4 rounded border-gray-300 text-primary focus:ring-primary tempo-528c1fe9-00ed-5928-91d0-f0bc3fe05cde",tempoelementid:"tempo-528c1fe9-00ed-5928-91d0-f0bc3fe05cde"},"269756607046587511518193056830416328266-74"),e.jsx(g,{htmlFor:`permission-${a.id}`,className:"text-sm tempo-81c6a860-73d8-597a-9390-1fced71284f7",tempoelementid:"tempo-81c6a860-73d8-597a-9390-1fced71284f7",children:a.label})]},a.id)})},"269756607046587511518193056830416328266-72"),e.jsx("p",{className:"text-xs text-muted-foreground tempo-eb4c5e62-ab8e-52c6-a0e3-b09a41d02654",tempoelementid:"tempo-eb4c5e62-ab8e-52c6-a0e3-b09a41d02654",children:"ملاحظة: الصلاحيات تعتمد على الدور أيضاً"},"269756607046587511518193056830416328266-76")]},"269756607046587511518193056830416328266-70"),e.jsxs("div",{className:"flex items-center space-x-2 space-x-reverse tempo-8a07e3d1-512e-5e2b-b6cc-c446a0b284b1",tempoelementid:"tempo-8a07e3d1-512e-5e2b-b6cc-c446a0b284b1",children:[e.jsx($e,{id:"is-active",checked:y("is_active"),onCheckedChange:a=>p("is_active",a),className:"tempo-43450186-1c62-519e-a3ec-ab825d504c30 ",tempoelementid:"tempo-43450186-1c62-519e-a3ec-ab825d504c30"}),e.jsx(g,{htmlFor:"is-active",className:"tempo-89172c9a-ae0b-562d-8715-98916946d39e ",tempoelementid:"tempo-89172c9a-ae0b-562d-8715-98916946d39e",children:"المستخدم نشط"})]},"269756607046587511518193056830416328266-77"),e.jsxs(we,{className:"gap-2 tempo-13b0918e-14fa-5185-8345-4d8e71df5334",tempoelementid:"tempo-13b0918e-14fa-5185-8345-4d8e71df5334",children:[e.jsx(w,{type:"button",variant:"outline",onClick:()=>j(!1),disabled:A,className:"tempo-e3a33e7e-2eb3-5fcf-a8bd-de0e6c9c8b53 ",tempoelementid:"tempo-e3a33e7e-2eb3-5fcf-a8bd-de0e6c9c8b53",children:"إلغاء"}),e.jsx(w,{type:"submit",disabled:A,className:"tempo-868a0bdf-ccc0-57d5-a9cc-c894bed84fed ",tempoelementid:"tempo-868a0bdf-ccc0-57d5-a9cc-c894bed84fed",children:A?e.jsxs(e.Fragment,{children:[e.jsx(P,{size:"sm",className:"ml-2 tempo-2686e3c9-98ca-527a-b789-f1fa040ff1ef",tempoelementid:"tempo-2686e3c9-98ca-527a-b789-f1fa040ff1ef"}),"جاري الحفظ..."]}):l?"تحديث":"إضافة"})]})]},"269756607046587511518193056830416328266-40")]})}),e.jsx(ye,{open:V,onOpenChange:$,className:"tempo-3a495f04-1ecd-5c8e-a8a7-2bd75fd7c3de ",tempoelementid:"tempo-3a495f04-1ecd-5c8e-a8a7-2bd75fd7c3de",children:e.jsxs(Se,{dir:"rtl",className:"tempo-78c39b00-7c52-5b07-ad4e-8e7abd9aca38 ",tempoelementid:"tempo-78c39b00-7c52-5b07-ad4e-8e7abd9aca38",children:[e.jsxs(Ee,{className:"tempo-f83a00b8-e75e-5cd4-9dfb-90d5ab6cd70e ",tempoelementid:"tempo-f83a00b8-e75e-5cd4-9dfb-90d5ab6cd70e",children:[e.jsx(_e,{className:"tempo-01eaf78f-527d-5fdb-8237-8c10f6eb3800 ",tempoelementid:"tempo-01eaf78f-527d-5fdb-8237-8c10f6eb3800",children:"هل أنت متأكد من حذف هذا المستخدم؟"}),e.jsx(Ue,{className:"tempo-ac9a012b-0448-543e-832a-541ac0e65716 ",tempoelementid:"tempo-ac9a012b-0448-543e-832a-541ac0e65716",children:"هذا الإجراء لا يمكن التراجع عنه. سيتم حذف المستخدم وجميع بياناته بشكل دائم."})]}),e.jsxs(ke,{className:"flex-row-reverse justify-start gap-2 tempo-522f35f7-244f-5439-a6ea-229963de5263",tempoelementid:"tempo-522f35f7-244f-5439-a6ea-229963de5263",children:[e.jsx(Ce,{className:"tempo-090620ea-4c50-51e9-8c05-cf3b49eb23ed ",tempoelementid:"tempo-090620ea-4c50-51e9-8c05-cf3b49eb23ed",children:"إلغاء"}),e.jsx(De,{onClick:Q,className:"bg-destructive hover:bg-destructive/90 tempo-068a067a-fc4f-59d0-86ce-6ebef8693b36",tempoelementid:"tempo-068a067a-fc4f-59d0-86ce-6ebef8693b36",children:"حذف"})]})]})})]},"269756607046587511518193056830416328266-19"):e.jsxs("div",{className:"flex h-full flex-col items-center justify-center p-4 text-center tempo-9eaea4f4-5bec-5463-8063-119f45cf7fb0",tempoelementid:"tempo-9eaea4f4-5bec-5463-8063-119f45cf7fb0",children:[e.jsx("h1",{className:"text-2xl font-bold text-red-600 mb-2 tempo-7b2207a4-325b-5ceb-8fc4-0dc4dfbf0c04",tempoelementid:"tempo-7b2207a4-325b-5ceb-8fc4-0dc4dfbf0c04",children:"غير مصرح"},"269756607046587511518193056830416328266-16"),e.jsx("p",{className:"mb-4 tempo-2fc24cd8-2297-592a-b00e-e958e967041f",tempoelementid:"tempo-2fc24cd8-2297-592a-b00e-e958e967041f",children:"ليس لديك صلاحية للوصول إلى هذه الصفحة"},"269756607046587511518193056830416328266-17"),e.jsx(w,{onClick:()=>window.history.back(),className:"tempo-ea0b0f6b-6c3d-535a-bad3-bfadb9df754e ",tempoelementid:"tempo-ea0b0f6b-6c3d-535a-bad3-bfadb9df754e",children:"العودة"})]},"269756607046587511518193056830416328266-15")}function Be(){return e.jsxs("div",{className:"space-y-6 tempo-e3eec056-b1a8-5d42-a7f9-1da7bde84eb6",dir:"rtl",tempoelementid:"tempo-e3eec056-b1a8-5d42-a7f9-1da7bde84eb6",children:[e.jsx(je,{title:"إدارة المستخدمين",description:"إضافة وتعديل وحذف المستخدمين وإدارة الصلاحيات",className:"tempo-4368b8e6-79a6-5719-a465-85b53c052cfd ",tempoelementid:"tempo-4368b8e6-79a6-5719-a465-85b53c052cfd"}),e.jsx(Ie,{className:"tempo-fcf498d0-ac34-5128-8e2e-5594fa124f4e ",tempoelementid:"tempo-fcf498d0-ac34-5128-8e2e-5594fa124f4e"})]},"196569639620821698117649781690154583828-1")}export{Be as default};
